<% @page_title = @post.title %>

<% @sidebar_position = 'right' %>

<section>

  <header>
    <h2>
      <%= link_to @post.title, view_blog_post_path( @post ) %>
    </h2>
    <h3>
      Posted by <%= user_profile_link( @post.author ) %>
      at <%= @post.posted_at.to_s( :time ) %>
      on <%= @post.posted_at.to_s( :shinydate ) %>
    </h3>
  </header>

  <%= sanitize @post.body %>

  <% if @post.tag_list.present? %>
  <p>
    Tags: <% @post.tag_list.each do |tag| %><%= link_to tag, tag_path( tag ) %> <% end %>
  </p>
  <% end %>

  <% if @post.discussion.present? %>
  <footer>
    <a onclick="toggleHidden('comment_form')"><%= t( '.reply' ) %></a>
  <footer>

  <div id="comment_form" hidden>
    <%= render partial: 'discussions/comment_form', locals: { discussion: @post.discussion } %>
  </div>
  <% end %>
</section>

<% if @post.discussion.present? %>
  <%= render partial: 'discussions/discussion', locals: { resource: @post } %>
<% end %>

<%= render partial: 'right_sidebar_join' %>
<%= render partial: 'sidebar' %>
